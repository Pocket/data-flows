{% set sql_engine = "snowflake" %}
{% set is_multi_statement = True %}
create TRANSIENT TABLE if not exists CURATED_FEED_PROSPECTS (
	PROSPECT_ID VARCHAR(16777216),
	SNOWFLAKE_LOADED_AT TIMESTAMP_TZ(9) DEFAULT CURRENT_TIMESTAMP(),
	FEED_ID VARCHAR(16777216),
	RESOLVED_ID VARCHAR(16777216),
	TYPE VARCHAR(16777216),
	STATUS VARCHAR(16777216),
	CURATOR VARCHAR(16777216),
	TIME_ADDED VARCHAR(16777216),
	TIME_UPDATED VARCHAR(16777216),
	TOP_DOMAIN_ID VARCHAR(16777216),
	TITLE VARCHAR(16777216),
	EXCERPT VARCHAR(16777216),
	IMAGE_SRC VARCHAR(16777216)
);
truncate table curated_feed_prospects;
COPY INTO curated_feed_prospects
(PROSPECT_ID, FEED_ID, RESOLVED_ID, TYPE, STATUS, CURATOR, TIME_ADDED, TIME_UPDATED, TOP_DOMAIN_ID, TITLE, excerpt, image_src)
  FROM @airflow.mysql.airflow_stage/curated_feed_exports_aurora/curated_feed_prospects{{environment}}
  FILE_FORMAT = (TYPE = CSV FIELD_DELIMITER = '|' SKIP_HEADER = 0);
